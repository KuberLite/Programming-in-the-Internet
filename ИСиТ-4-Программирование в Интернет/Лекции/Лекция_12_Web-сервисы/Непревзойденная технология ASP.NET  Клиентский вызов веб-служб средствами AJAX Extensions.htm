<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0054)http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx -->
<html xmlns="http://www.w3.org/1999/xhtml" style="" overflow:auto""=""><head id="ctl00_Head"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link id="ctl00_HeaderLink2" rel="stylesheet" type="text/css" href="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/Msdn10a-bn1651.css"><link id="ctl00_HeaderLink3" rel="stylesheet" type="text/css" href="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/Magazine2-bn1651.css"><link rel="alternate" type="application/rss+xml" title="MSDN Magazine - Current Issue" href="http://msdn.microsoft.com/magazine/rss/default.aspx?z=z&iss=1"><link rel="alternate" type="application/rss+xml" title="MSDN Magazine - Complete" href="http://msdn.microsoft.com/magazine/rss/default.aspx?z=z&all=1"><link rel="alternate" type="application/rss+xml" title="MSDN Magazine Blog" href="http://blogs.msdn.com/msdnmagazine/rss.xml"><meta name="NormalizedUrl" content="http://msdn.microsoft.com/ru-ru/magazine(d=lightweight)/cc163499(l=ru-ru,v=MSDN.10).aspx"><meta name="VotingContextUrl" content="http://msdn.microsoft.com/ru-ru/magazine(d=lightweight)/cc163499(l=ru-ru,v=MSDN.10).aspx"><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"><meta name="MN" content="D1DC116D-10:38:09 PM"><meta name="ms.locale" content="ru-ru"><meta name="Search.ShortId" content="cc163499">
<!-- Looking for metadata? Use the robot view instead http://currentsite/currenturl(robot).aspx -->
<link rel="stylesheet" type="text/css" href="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/mtps-bn1651.css"><link rel="alternate" media="print" href="http://msdn.microsoft.com/ru-ru/magazine/cc163499(printer).aspx">
<title>
	Непревзойденная технология ASP.NET:  Клиентский вызов веб-служб средствами AJAX Extensions
</title></head>
<body id="ctl00_MTPS_Body" class="MsdnPageBody" dir="ltr">
    <form name="aspnetForm" method="post" action="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions.htm" id="aspnetForm">
<div>
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="">
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUBMGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFImN0bDAwJE1hc3RoZWFkJFNlYXJjaCRTZWFyY2hCdXR0b260Ww6FMWki6x7JsKyyp4xsOxXbTA==">
</div>

<script type="text/javascript" async="" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/ms2.js"></script><script type="text/javascript">
//<![CDATA[
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>


<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/WebResource.axd" type="text/javascript"></script>


<script type="text/javascript">
//<![CDATA[
var CurUserId="AxUFAAAAAAC5BwAACuaaalxIPcjQZsqJV7EVew!!";var ClientURL="http%3a%2f%2fmsdn.microsoft.com%2fru-ru%2fmagazine(d%3dlightweight)%2fcc163499(l%3dru-ru%2cv%3dMSDN.10).aspx";var maxRating=5;var RatingObjId="ctl00_tb1_Flyout_Rating1";var tbCommentsId="ctl00_tb1_Flyout_tbComments";var PageId="cc163499";var pageTag="contentRatingcc163499MSDN.10ru-ru";var sendBtnId="ctl00_tb1_Flyout_btnSend";var curRating="0";var contentRated=false;var RatingTooltipText="Щелкните символ звезды и оставьте отзыв";var RatedTooltipText="Вы уже оценили полезность этого материала. Спасибо за вашу оценку.";var userIPAddress="87.252.227.9";var MtpsPageDirection="ltr";var RatingFlyoutID="ctl00_tb1_Flyout";var Rating_Device="lightweight";//]]>
</script>

<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/jquery-1.2.6-bn1651.js" type="text/javascript"></script>
<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/Silverlight-bn1651.js" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
var wt_nvr_ru = "WT_NVR_RU";var wt_fpcdom = ".microsoft.com";var wt_domlist = "msdn.microsoft.com";var wt_pathlist = "";var wt_paramlist = "DCSext.mtps_devcenter";var wt_siteid = "MSDN";var gDomain="m.webtrends.com";
var gDcsId="dcsmgru7m99k7mqmgrhudo0k8_8c6m";
var gFpc="WT_FPC";
/*<![CDATA[*/
if(document.cookie.indexOf(gFpc+"=")==-1){document.write("<scr"+"ipt type='text/javascript' src='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'><\/scr"+"ipt>");}
/*]]>*/
var detectedLocale = 'ru-ru';
var wtsp="_msdnmag_";
var gTrackEvents = 1;
var omni_guid='b3c7ce63-a4ce-4549-b84e-ba1159d65067';//]]>
</script>
<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/omni_rsid_msdn-bn1651.js" type="text/javascript"></script><noscript>&lt;a href='http://www.omniture.com' title='Web Analytics'&gt;&lt;img src='http://msstonojsmsdn.112.2o7.net/b/ss/msstonojsmsdn/1/H.20.2--NS/0'  height='1' width='1' border='0' alt='' /&gt;&lt;/a&gt;</noscript>
<script type="text/javascript">
//<![CDATA[
$(document).ready(function() { var sf = "a[@rel$='sitefeedback']"; if ($(sf) == null) return;  $(sf).click(function() {   var t = $(this).attr('targetUrl');   window.open(t,'SiteFeedback','width=670,resizable=no,height=700,toolbar=no,location=no,scrollbars=yes,directories=no,status=no,menubar=no'); return false; }); });//]]>
</script>

<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/compositejscript3.js" type="text/javascript"></script>
    <script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('ctl00$ScriptManager1', 'aspnetForm', [], [], [], 90, 'ctl00');
//]]>
</script>

    <div id="ctl00_checkFlyer">

</div>
    
    
    <div id="BodyBackground">
        <div id="ctl00_JelloSizer" class="JelloSizer">
            <div id="JelloExpander">
                <div id="ctl00_JelloWrapper" class="JelloWrapper">
                    <div class="Clear"> </div>
                    
                        <div class="Clear"> </div>
                        

<div class="Masthead">
    <div id="ctl00_Masthead_brandLogo" class="BrandLogo">
        <a href="http://msdn.microsoft.com/ru-ru/magazine/default.aspx" id="ctl00_Masthead_brandlink" title="Журнал MSDN Magazine">Журнал MSDN Magazine</a>
    </div>
    <div class="Search">
        <div id="ctl00_Masthead_Search_SearchBox" class="SearchBox">
    <input name="ctl00$Masthead$Search$SearchTextBox" type="text" id="ctl00_Masthead_Search_SearchTextBox" title="Поиск MSDN Magazine с помощью Bing" class="TextBoxSearch" autocomplete="off" style="color: rgb(170, 170, 170); font-style: italic; ">
    <input type="image" name="ctl00$Masthead$Search$SearchButton" id="ctl00_Masthead_Search_SearchButton" title="Поиск MSDN Magazine с помощью Bing" class="SearchButton" alt="Чтобы начать поиск, щелкните здесь" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;">
    <span class="Bing"></span>
<script type="text/javascript" defer="defer" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/SearchBox.jss" id="mscom.srch.searchBox"></script><div id="SearchFlyoutContainer" style="display: none; text-align: left; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-color: buttonshadow; border-right-color: buttonshadow; border-bottom-color: buttonshadow; border-left-color: buttonshadow; border-image: initial; position: absolute; z-index: 1000; padding-top: 2px; padding-right: 2px; padding-bottom: 2px; padding-left: 2px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 255); font-family: arial; "><div id="SuggestionContainer"><ul style="list-style-type: none; list-style-position: initial; list-style-image: initial; padding-top: 4px; padding-right: 2px; padding-bottom: 0px; padding-left: 1px; cursor: pointer; font-size: 8pt; margin-top: 1px; margin-right: 1px; margin-bottom: 1px; margin-left: 1px; "></ul></div><div id="FooterContainer" style="width: 100%; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; text-align: right; font-size: 8pt; "><a href="http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx#">Закрыть</a></div></div></div>
    </div>
    <div class="GlobalBar">
        <div id="ctl00_Masthead_passportScarab" class="PassportScarab"> 
            <a id="idPPScarab" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=11&ct=1332221890&rver=6.0.5276.0&wp=MCLBI&wlcxt=msdn%24msdn%24msdn&wreply=http%3a%2f%2fmsdn.microsoft.com%2fru-ru%2fmagazine%2fcc163499.aspx&lc=1049&id=254354&mkt=ru-RU"><span id="idPPScarabSIT" class="MTPS_GlobalToolbarLinks_msdn">Вход</span></a>
<div id="idPPMWOverlay" style="display: none;"></div>
        </div>
        <div class="LocaleFlyout">
            
    <div id="MainDiv" onmouseover="FlyoutPopupShow()" onmouseout="FlyoutPopupHide()">
        <div id="FlyoutTop">
            <a id="ctl00_Masthead_LocaleManagement_linkCountryLanguage" class="LocaleManagementFlyoutStaticLink">Россия - русский&nbsp;</a>
            <img id="img_Arrow" class="LocaleManagementFlyoutPopArrow" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" alt="">
        </div>
        <div id="FlyoutPopup" class="LocaleManagementFlyoutPopup" style="display: none; ">
            <table class="LocaleManagementFlyoutPopupTable">
                <tbody><tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Arg" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Arg','')">
                Argentina (Español)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Bra" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Bra','')">
                Brasil (Português)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_CanE" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_CanE','')">
                Canada (English)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_CanF" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_CanF','')">
                Canada (Français)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Chi" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Chi','')">
                中国 (简体中文)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Col" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Col','')">
                Colombia (Español)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Deu" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Deu','')">
                Deutschland (Deutsch)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Esp" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Esp','')">
                España (Español)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Fra" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Fra','')">
                France (Français)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Ind" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Ind','')">
                India (English)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Ita" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Ita','')">
                Italia (Italiano)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Jpa" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Jpa','')">
                日本 (日本語)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Kor" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Kor','')">
                한국 (한국어)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Mex" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Mex','')">
                México (Español)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Per" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Per','')">
                Perú (Español)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Рос" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Рос','')">
                Россия (Pусский)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_Tai" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_Tai','')">
                台灣 (繁體中文)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_UK" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_UK','')">
                United Kingdom (English)</a></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_US" href="javascript:__doPostBack('ctl00$Masthead$LocaleManagement$lkbtn_US','')">
                United States (English)</a></td></tr>
                <tr><td class="LocaleManagementFlyoutPopupHr"></td></tr>
                <tr><td><a id="ctl00_Masthead_LocaleManagement_lkbtn_More" href="http://msdn.microsoft.com/ru-ru/ms376822.aspx">Дополнительно…</a></td></tr>
            </tbody></table>
        </div>
    </div>


        </div>
        <div class="Clear"></div>
        <div id="ctl00_Masthead_ProfileLink_UserName" class="UserName"></div>
    </div>
    <div class="Clear"></div>
    <div id="ctl00_Masthead_networkTagLineArea" class="NetworkLogo">
        <a href="http://msdn.microsoft.com/ru-ru/default.aspx" id="ctl00_Masthead_networkLink"><img title="microsoft developer network" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/brand_logo.png" style="border-width:0px;"></a>
    </div>
    

<div class="leftcap"></div>
    <div class="internav">
	    <div id="ctl00_Masthead_tabs_manTabsHolder"><a id="ctl00_Masthead_tabs_ctl07" title="Главная" class="active" href="http://msdn.microsoft.com/ru-ru/magazine/default.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl06|ctl00_Masthead_tabs_ctl07&#39;,this);">Главная</a><a id="ctl00_Masthead_tabs_ctl09" title="Темы" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/ee532082.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl08|ctl00_Masthead_tabs_ctl09&#39;,this);">Темы</a><a id="ctl00_Masthead_tabs_ctl11" title="Рубрики" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/ee532401.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl10|ctl00_Masthead_tabs_ctl11&#39;,this);">Рубрики</a><a id="ctl00_Masthead_tabs_ctl13" title="Загрузки" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/cc135867.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl12|ctl00_Masthead_tabs_ctl13&#39;,this);">Загрузки</a><a id="ctl00_Masthead_tabs_ctl15" title="Подписаться" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/ee358702.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl14|ctl00_Masthead_tabs_ctl15&#39;,this);">Подписаться</a><a id="ctl00_Masthead_tabs_ctl17" title="RSS" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/cc194384.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl16|ctl00_Masthead_tabs_ctl17&#39;,this);">RSS</a></div>
    </div>
<div class="rightcap"></div>
<div class="Clear"></div>
<div id="ctl00_Masthead_tabs_LocalNavigation" class="LocalNavigation">
    <div class="localleftcap"></div>
        <div id="ctl00_Masthead_tabs_InThisSection" class="HeaderTabs"><div class="TabOff"><a id="ctl00_Masthead_tabs_ctl01" title="Текущий выпуск" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/default.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl00|ctl00_Masthead_tabs_ctl01&#39;,this);">Текущий выпуск</a></div><div class="TabOn"><a id="ctl00_Masthead_tabs_ctl03" title="Все выпуски" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/ee310108.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl02|ctl00_Masthead_tabs_ctl03&#39;,this);">Все выпуски</a></div><div class="TabOff"><a id="ctl00_Masthead_tabs_ctl05" title="Файлы справки в формате HTML" class="normal" href="http://msdn.microsoft.com/ru-ru/magazine/ee412244.aspx" onclick="javascript:Track(&#39;|TabStrip Link|ctl00_Masthead_tabs_ctl04|ctl00_Masthead_tabs_ctl05&#39;,this);">Файлы справки в формате HTML</a></div></div>
    <div class="localrightcap"></div>
</div>   
</div>
                        <div class="Clear"> </div>
                        <div class="topleftcorner"> </div>
                        <div class="toprightcorner"> </div>
                        <div class="alley">
                            <div class="wrapper">
                                <div class="inner">
                                    
                                    <div class="Clear"> </div>
                                    <div id="ctl00_EyebrowMenu_EyebrowContainer" class="EyebrowContainer"><a id="ctl00_EyebrowMenu_ctl00" title="Журнал MSDN Magazine" class="EyebrowLink" href="http://msdn.microsoft.com/ru-ru/magazine/dd767791.aspx" onclick="javascript:Track(&#39;|Eyebrow|ctl00_EyebrowMenu_EyebrowContainer|ctl00_EyebrowMenu_ctl00&#39;,this);">Журнал MSDN Magazine</a><span>&nbsp;&gt;&nbsp;</span><a id="ctl00_EyebrowMenu_ctl01" title="Главная" class="EyebrowLink" href="http://msdn.microsoft.com/ru-ru/magazine/dd767791.aspx" onclick="javascript:Track(&#39;|Eyebrow|ctl00_EyebrowMenu_EyebrowContainer|ctl00_EyebrowMenu_ctl01&#39;,this);">Главная</a><span>&nbsp;&gt;&nbsp;</span><a id="ctl00_EyebrowMenu_ctl02" title="Все выпуски" class="EyebrowLink" href="http://msdn.microsoft.com/ru-ru/magazine/ee310108.aspx" onclick="javascript:Track(&#39;|Eyebrow|ctl00_EyebrowMenu_EyebrowContainer|ctl00_EyebrowMenu_ctl02&#39;,this);">Все выпуски</a><span>&nbsp;&gt;&nbsp;</span><a id="ctl00_EyebrowMenu_ctl03" title="2007" class="EyebrowLink" href="http://msdn.microsoft.com/ru-ru/magazine/cc135849.aspx" onclick="javascript:Track(&#39;|Eyebrow|ctl00_EyebrowMenu_EyebrowContainer|ctl00_EyebrowMenu_ctl03&#39;,this);">2007</a><span>&nbsp;&gt;&nbsp;</span><a id="ctl00_EyebrowMenu_ctl04" title="January" class="EyebrowLink" href="http://msdn.microsoft.com/ru-ru/magazine/cc135430.aspx" onclick="javascript:Track(&#39;|Eyebrow|ctl00_EyebrowMenu_EyebrowContainer|ctl00_EyebrowMenu_ctl04&#39;,this);">January</a><span>&nbsp;&gt;&nbsp;</span><span class="EyebrowElement">&nbsp;Непревзойденная технология ASP.NET:  Клиентский...</span></div>
                                    <div class="Clear"> </div>
                                    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="width: 100%; table-layout: fixed;">
                                        <tbody><tr>
                                            <td style="vertical-align: top; width: auto;" valign="top">
                                                
                                                <div id="MainContent" style="width: 100%">
                                                    
                                                            
                                                            <div class="topic">
                              <div>
                                        <div class="ColumnTypeTitle">Непревзойденная технология ASP.NET</div>
                                        <div class="ColumnTypeSubTitle"> Клиентский вызов веб-служб средствами AJAX Extensions</div>
                                        <div class="ColumnByLine"> Фриц Онион (Fritz Onion)</div>
                                        <br>
                                        <span class="CodeDownloadText">Код доступен для загрузки по адресу:
  </span>
                                        <a href="http://download.microsoft.com/download/f/2/7/f279e71e-efb0-4155-873d-5554a0608523/ExtremeASPNET2007_01.exe">ExtremeASPNET2007_01.exe</a>
                                        <span class="CodeDownloadText">
    (160 KB)
  </span>
                                        <br>
                                        <span>
                                                  <a id="ctl00_MTContentSelector1_mainContentContainer_ctl01" href="http://msdn.microsoft.com/ru-ru/magazine/cc164527.aspx" onclick="javascript:Track(&#39;ctl00_MTContentSelector1_mainContentContainer_ctl00|ctl00_MTContentSelector1_mainContentContainer_ctl01&#39;,this);">Browse the Code Online</a>
                                        </span>
                                        <div>
                                                  <span class="CodeDownloadText">
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Содержание
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                            <a href="http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx#S1">Вызов веб-служб средствами AJAX</a>
                                                            <br>
                                                            <a href="http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx#S2">Как это работает</a>
                                                            <br>
                                                            <a href="http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx#S3">Сериализация</a>
                                                            <br>
                                                            <a href="http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx#S4">Заключение</a>
                                                            <br>
                                                  
</div>
</div>
</span>
                                                  <br>
                                        </div>
                                        <div class="ArticleNormalPara">С момента своего создания среда ASP.NET была принципиально серверной технологией. Конечно, в некоторых случаях можно было использовать ASP.NET для создания клиентских сценариев JavaScript, в основном это касалось элементов управления проверки, а в последнее время — инфраструктуры веб-частей. Но в большинстве случаев это было всего лишь преобразованием серверных свойств в клиентское поведение, и разработчику не приходилось заботиться о взаимодействии с клиентом до получения следующего POST-запроса. Для создания более интерактивных страниц с клиентскими сценариями JavaScript и DHTML разработчикам приходилось действовать самостоятельно, используя только функцию ответных вызовов сценариев ASP.NET 2.0. За последний год ситуация в корне изменилась.</div>
                                        <div class="ArticleNormalPara">На конференции профессиональных разработчиков Microsoft Professional Developer's Conference в сентябре 2005 г. корпорация Майкрософт анонсировала новый дополнительный компонент ASP.NET с кодовым названием «Atlas», специально созданный для расширения возможностей клиентских сценариев JavaScript, DHTML и объекта XMLHttpRequest. Это было сделано с целью помочь разработчикам в создании более интерактивных веб-приложений на основе средств AJAX. Эта инфраструктура, компоненты которой носят теперь официальные названия Microsoft<span class="superscript">®</span> AJAX Library и ASP.NET 2.0 AJAX Extensions, предлагает множество замечательных функций от клиентской привязки данных до анимации и поведения DHTML и сложного метода перехвата клиентских обратных отправок POST с помощью элемента управления UpdatePanel. В основе многих из этих функций лежит способность асинхронно получать от сервера данные в форме, удобной для анализа и взаимодействия из клиентских вызовов JavaScript. Тема статьи этого месяца — новая и чрезвычайно полезная возможность вызова серверных веб-служб из клиентского сценария JavaScript на страницах, использующих расширения ASP.NET 2.0 AJAX Extensions.</div>
                                        <br>
                                        <div class="ArticleTypeTitle" id="S1">Вызов веб-служб средствами AJAX</div>
                                        <div class="ArticleNormalPara">Для тех, кто когда-нибудь пользовался веб-службой в среде Microsoft .NET Framework либо путем создания прокси с помощью служебной программы wsel.exe, либо путем использования функции Add Web Reference (добавить веб-ссылку) системы Microsoft Visual Studio<span class="superscript">®</span>, вызов веб-служб с помощью типов .NET — дело привычное. Фактически вызов метода веб-службы с помощью прокси .NET осуществляется точно так же, как и вызов методов любого другого класса. Прокси формирует XML-код на основе переданных параметров и точно преобразует полученный ответ в формате XML в тип .NET, соответствующий методу прокси. Простота работы с конечными точками веб-служб в среде .NET Framework предоставляет разработчикам множество возможностей и является одной из основ, на которые сегодня опирается возможность применения приложений, ориентированных на использование служб.</div>
                                        <div class="ArticleNormalPara">Расширения ASP.NET 2.0 AJAX Extensions позволяют так же легко создавать прокси для веб-служб клиентских сценариев JavaScript, работающих в веб-обозревателе. Можно создать на сервере ASMX-файл и вызывать методы этой службы с помощью клиентских классов JavaScript. На <strong>рис. 1</strong> приведен пример простой службы ASMX, которая получает фиктивную котировку акций, содержащую случайные данные.</div>
                                        <span>
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Figure&nbsp;1&nbsp;StockQuoteService.asmx
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                  <span id="ctl00_MTContentSelector1_mainContentContainer_ctl29_ctl00_ctl00" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl29_ctl00_ctl00_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl29_ctl00_ctl00_code" space="preserve">&lt;%@ WebService Language="C#"
               Class="MsdnMagazine.StockQuoteService" %&gt;

using System;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;
// From Microsoft.Web.Extensions.dll assembly
using Microsoft.Web.Script.Services; 

namespace MsdnMagazine
{
    [WebService(Namespace = "http://msdnmagazine.com/ws")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [ScriptService]
    public class StockQuoteService : WebService
    {
        static Random _rand = new Random(Environment.TickCount);

        [WebMethod]
        public int GetStockQuote(string symbol)
        {
            return _rand.Next(0, 120);
        }
    }
}

</pre>
    </div>
</div>

</span>
                                        
</div>
</div>
</span>
                                        <div class="ArticleNormalPara">В дополнение к стандартным ASMX-атрибутам веб-служб эта служба имеет атрибут ScriptService, что делает ее доступной для клиентов JavaScript. Если этот ASMX-файл развернут в веб-приложении ASP.NET на основе AJAX, можно вызывать методы данной службы из сценария JavaScript, добавив атрибут ServiceReference в элемент управления ScriptManager в ASPX-файле (при создании веб-узла в Visual Studio с помощью шаблона веб-узла ASP.NET на основе AJAX этот элемент управления автоматически добавляется на страницу default.aspx):
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl05" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl05_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl05_code" space="preserve">&lt;asp:ScriptManager ID="_scriptManager" runat="server"&gt;
  &lt;Services&gt;
    &lt;asp:ServiceReference Path="StockQuoteService.asmx" /&gt;
  &lt;/Services&gt;
&lt;/asp:ScriptManager&gt;
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">Теперь в любой клиентской подпрограмме JavaScript можно использовать класс MsdnMagazine.StockQuoteService для вызова любых методов этой службы. Поскольку основной механизм вызова по своей сути асинхронен, синхронные методы недоступны. Вместо этого у каждого метода прокси кроме стандартных входных параметров есть дополнительный параметр — ссылка на другую клиентскую функцию JavaScript, вызываемую асинхронно после завершения работы метода. В примере на <strong>рис. 2</strong> используется клиентский сценарий JavaScript для печати результата вызова веб-службы котировки акций в метку (диапазон) на странице.</div>
                                        <span>
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Figure&nbsp;2&nbsp;Пример клиентской страницы веб-службы
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                  <span id="ctl00_MTContentSelector1_mainContentContainer_ctl31_ctl00_ctl00" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl31_ctl00_ctl00_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl31_ctl00_ctl00_code" space="preserve">&lt;%@ Page Language="C#" %&gt;

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;

&lt;html  &gt;
&lt;head runat="server"&gt;
 &lt;title&gt;ASP.NET AJAX Web Services: Web Service Sample Page&lt;/title&gt;

 &lt;script type="text/javascript"&gt; 
    function OnLookup()
    {           
      var stb = document.getElementById("_symbolTextBox");  
      MsdnMagazine.StockQuoteService.GetStockQuote(
        stb.value, OnLookupComplete);
    }
    
    function OnLookupComplete(result)
    {
      var res = document.getElementById("_resultLabel");
      res.innerHTML = "&lt;b&gt;" + result + "&lt;/b&gt;";
    }
  &lt;/script&gt;    
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
    &lt;asp:ScriptManager ID="_scriptManager" runat="server"&gt;
      &lt;Services&gt;
        &lt;asp:ServiceReference 
             Path="services/StockQuoteService.asmx" /&gt;
      &lt;/Services&gt;
    &lt;/asp:ScriptManager&gt;
    &lt;div&gt;
    &lt;h1&gt;ASP.NET AJAX Web Services: Web Service Sample Page&lt;/h1&gt;
    Enter symbol: 
    &lt;asp:TextBox runat="server" id="_symbolTextBox" /&gt;
    &lt;br /&gt;
    &lt;input onclick="OnLookup();" id="_lookupButton" type="button" 
           value="Lookup" /&gt;
    &lt;br /&gt;
    &lt;asp:Label runat="server" id="_resultLabel" /&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
    </div>
</div>

</span>
                                        
</div>
</div>
</span>
                                        <div class="ArticleNormalPara">Конечно, в случае возникновения проблем с клиентским вызовом веб-службы нужно сообщить об этом клиенту. Поэтому разумно использовать дополнительный метод, который можно вызвать при ошибке, прерывании или по истечении времени ожидания. Например, можно следующим образом изменить метод OnLookup, добавив метод OnError для вывода на экран ошибок:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl08" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl08_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl08_code" space="preserve">function OnLookup()
{           
  var stb = document.getElementById("_symbolTextBox");  
  MsdnMagazine.StockQuoteService.GetStockQuote(
    stb.value, OnLookupComplete, OnError);
}
    
function OnError(result)
{
  alert("Error: " + result.get_message());
}
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">Таким образом, в случае сбоя при вызове веб-службы клиент увидит окно с предупреждением. В вызовы веб-службы, выполняемые клиентом, можно включить параметр userContext, который является произвольной строкой, передаваемой в качестве последнего параметра веб-методу. Он будет распространяться и на метод, вызываемый при успешном вызове, и на метод, вызываемый при сбое, как дополнительный параметр. Возможно, в этом случае целесообразно передавать действительный код акций, котировка которых запрашивается, через userContext для того, чтобы вывести его на экран в методе OnLookupComplete:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl09" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl09_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl09_code" space="preserve">function OnLookup()
{           
  var stb = document.getElementById("_symbolTextBox");  
  MsdnMagazine.StockQuoteService.GetStockQuote(
    stb.value, OnLookupComplete, OnError, stb.value);
}

function OnLookupComplete(result, userContext)
{
  // userContext contains symbol passed into method
  var res = document.getElementById("_resultLabel");
  res.innerHTML = userContext + " : &lt;b&gt;" + result + "&lt;/b&gt;";
}
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">Если делается много различных вызовов веб-службы, и при этом для каждого вызова используются одни и те же ошибки и методы завершения, можно глобально назначить соответствующие методы ответного вызова, используемые по умолчанию. Это позволит не указывать пары методов ответного вызова каждый раз, когда делается вызов, хотя в каждом конкретном случае методы, вызываемые по умолчанию, могут быть переопределены. Ниже приведен пример метода OnLookup, устанавливающего методы ответного вызова, вызываемые при ошибке и при успешном завершении, глобально, а не для каждого вызова.
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl10" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl10_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl10_code" space="preserve">// Set default callbacks for stock quote service
MsdnMagazine.StockQuoteService.set_defaultSucceededCallback(
                 OnLookupComplete);
MsdnMagazine.StockQuoteService.set_defaultFailedCallback(
                 OnError);
function OnLookup()
{           
  MsdnMagazine.StockQuoteService.GetStockQuote(stb.value);
}
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">Есть и другая интересная альтернатива созданию полного ASMX-файла для методов веб-службы — внедрение методов веб-службы непосредственно в класс страницы. Если нецелесообразно создавать завершенную конечную точку веб-службы для вызываемых методов, можно предоставить доступ к веб-методу на странице, вызываемому клиентским сценарием JavaScript, добавив на страницу — непосредственно или в фоновый код — серверный метод и пометив его атрибутом WebMethod. В этом случае его можно будет вызывать с помощью клиентского объекта PageMethods. На <strong>рис. 3</strong> приведен пример службы получения котировок, которая изменена так, что содержится в пределах одной страницы, а не выделяется в отдельную веб-службу.
</div>
                                        <span>
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Figure&nbsp;3&nbsp;Служба получения котировок на одной странице
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                  <span id="ctl00_MTContentSelector1_mainContentContainer_ctl35_ctl00_ctl00" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl35_ctl00_ctl00_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl35_ctl00_ctl00_code" space="preserve">&lt;%@ Page Language="C#" %&gt;

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;

&lt;html  &gt;
&lt;head runat="server"&gt;
&lt;title&gt;ASP.NET AJAX Web Services: Web Service Sample Page&lt;/title&gt;
  &lt;script runat="server"&gt;
        private static Random _rand = new Random();
        
        [WebMethod]
        public static float GetStockQuoteFromPage(string symbol)
        {
            return _rand.Next(0, 120);
        }
  &lt;/script&gt;

  &lt;script type="text/javascript"&gt;    
  function OnLookup()
  {           
    var stb = document.getElementById("_symbolTextBox");       
    PageMethods.GetStockQuoteFromPage(stb.value,
                  OnLookupComplete);
  }
    
  function OnLookupComplete(result)
  {
    var res = document.getElementById("_resultLabel");
    res.innerHTML = "&lt;b&gt;" + result + "&lt;/b&gt;";
  }
  &lt;/script&gt;  
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
    &lt;div&gt;    
    &lt;h1&gt; ASP.NET AJAX Web Services: Web Service Sample Page &lt;/h1&gt;
     Enter symbol: 
        &lt;asp:TextBox runat="server" id="_symbolTextBox" /&gt;
        &lt;br /&gt;
        &lt;input onclick="OnLookup();" id="_lookupButton" 
               type="button" value="Lookup" /&gt;
        &lt;br /&gt;
        &lt;asp:Label runat="server" id="_resultLabel" /&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
    </div>
</div>

</span>
                                        
</div>
</div>
</span>
                                        <div class="ArticleNormalPara">Необходимо иметь в виду, что такие клиентские прокси могут создаваться только конечными точками ASMX среды ASP.NET, конечными точками SVC системы Windows Communication Foundation или методами WebMethods, внедренными непосредственно в страницу, и не являются общим механизмом для вызова произвольных веб-служб. Более того, имеет место общее ограничение на основной объекта XmlHTTPRequest, заключающееся в том, что в целях безопасности запросы могут поступать только к тому домену, с которого была загружена страница. Таким образом, данный метод неприменим для вызова произвольных веб-служб, даже если они поддерживаются клиентскими прокси. При необходимости вызова внешних веб-служб лучше всего создать связующую конечную точку ASMX в собственном приложении, которое обращается к прокси-классу .NET внешней веб-службы, созданному с помощью wsdl.exe или функции Add Web Reference в Visual Studio.</div>
                                        <br>
                                        <div class="ArticleTypeTitle" id="S2">Как это работает</div>
                                        <div class="ArticleNormalPara">На первый взгляд удивительно, что доступ к стандартной веб-службе ASMX из клиентского сценария JavaScript в обозревателе может осуществляться практически без внесения изменений в код веб-службы. Секрет заключается в регистрации нового HTTP-обработчика ASMX и добавлении его в файл конфигурации каждого веб-узла ASP.NET на основе средств AJAX:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl13" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl13_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl13_code" space="preserve">&lt;httpHandlers&gt;
  &lt;remove verb="*" path="*.asmx"/&gt;
  &lt;add verb="*" path="*.asmx" 
       type="Microsoft.Web.Services.ScriptHandlerFactory" 
       validate="false"/&gt;
&lt;/httpHandlers&gt;
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">В случае стандартного вызова веб-службы, направленного к конечной точке ASMX, вновь зарегистрированный обработчик вызывает стандартный обработчик веб-службы (System.Web.Services.Protocols.WebServiceHandlerFactory). Однако если запрос содержит URL-адрес, оканчивающийся на «/js», или содержит строку запроса, включающую текст вида «mn=переменная» (например «?mn=GetStockQuote»), обработчик либо возвращает фрагмент кода JavaScript, который создает клиентский прокси для веб-службы (параметр «/js»), либо вызывает соответствующий метод, определенный в классе, производном от WebService, и помещает ответ в строку в формате JavaScript Object Notation (JSON) (параметр «?mn=»).
</div>
                                        <div class="ArticleNormalPara">Если страница содержит клиентскую ссылку на службу ASMX (посредством атрибута ServiceReference элемента управления ScriptManager), она вставляет элемент сценария, который указывает на ASMX-файл с окончанием «/js», создавая прокси на стороне клиента. Например, страница для получения котировок, приведенная выше, выполняет обработку с помощью следующего элемента сценария:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl14" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl14_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl14_code" space="preserve">&lt;script src="StockQuoteService.asmx/js" 
        type="text/javascript"&gt;&lt;/script&gt;
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">И это, конечно, не считая ссылок, добавленных для клиентской библиотеки Microsoft AJAX Libraries, которая содержит клиентские функции, необходимые для взаимодействия с этим прокси. Фрагмент кода JavaScript, содержащий эту конечную точку, выглядит следующим образом:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl15" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl15_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl15_code" space="preserve">Type.registerNamespace('MsdnMagazine');
MsdnMagazine.StockQuoteService=function() {
  this._timeout = 0;
  this._userContext = null;
  this._succeeded = null;
  this._failed = null;
}
MsdnMagazine.StockQuoteService.prototype={
GetStockQuote:Sys.Net._WebMethod._createProxyMethod(this,
     "GetStockQuote", 
     "MsdnMagazine.StockQuoteService.GetStockQuote",
     "symbol"), ...
}
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">В этом сценарии, как и на любой странице, содержащей элемент управления ScriptManager, используются функции клиентской библиотеки Microsoft AJAX Libraries, например пространства имен и класс WebMethod. Строка запроса (в данном случае «?mn=GetStockQuote») запускает данный метод прокси, созданный этим сценарием JavaScript, для запроса к конечной точке. Поэтому при вызове MsdnMagazine.StockQuoteService.GetStockQuote на стороне клиента этот метод превращается в асинхронный веб-запрос к той же самой конечной точке. Создание клиентского прокси и серверная поддержка вызовов веб-службы, инициированных сценариями JavaScript, дают возможность включать клиентские вызовы в веб-службы ASMX интуитивно-понятным способом.</div>
                                        <br>
                                        <div class="ArticleTypeTitle" id="S3">Сериализация</div>
                                        <div class="ArticleNormalPara">Форматом сериализации, используемым по умолчанию для сериализации веб-служб на основе AJAX, является JSON. При трассировке страницы, приведенной в заключительной части статьи, тело запроса веб-службы и ответа будут выглядеть следующим образом:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl16" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl16_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl16_code" space="preserve">Request: {"symbol":"ABC"}
Response: 51
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">И это не похоже на привычный XML-формат, используемый для вызова веб-служб ASMX. Поскольку конечные точки ASMX сериализуются в формат XML, одним из важнейших элементов ASP.NET 2.0 AJAX Extensions является сериализатор JSON. Вообще говоря, их два. Один реализован в JavaScript для работы на стороне клиента, другой — в .NET и используется на стороне сервера, в частности, при вызове клиентом AJAX конечной точки ASMX. Доступ к серверному сериализатору осуществляется посредством класса Microsoft.Web.Script.Serialization.JavaScriptSerializer, а к клиентскому — посредством класса Sys.Serialization.JavaScriptSerializer. Одним из главных преимуществ JSON как формата сериализации перед XML состоит в возможности десериализации объектов в JavaScript простым анализом строк в формате JSON. Метод deserialize класса клиентского сериализатора получается очень коротким (проверка ошибок удалена):
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl17" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl17_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl17_code" space="preserve">Sys.Serialization.JavaScriptSerializer.deserialize=
    function(){eval('('+data+')');}
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">С другой стороны, метод serialize в JavaScriptSerializer значительно более сложен. Другим преимуществом JSON является относительно более компактное представление по сравнению с эквивалентом в формате XML.</div>
                                        <div class="ArticleNormalPara">Практически так же, как в стандартных веб-службах XmlSerializer сериализует типы в XML, JavaScriptSerializer сериализует почти любой тип .NET в JSON. В этом можно убедиться, просто вызвав метод Serialize класса JavaScriptSerializer. На <strong>рис. 4</strong> приведен пример консольного приложения, которое сериализует сложный тип Person, показанный на <strong>рис. 5</strong>. Приложение должно содержать ссылку на динамическую библиотеку Microsoft.Web.Extensions.dll, установленную в глобальном кэше сборок ASP.NET AJAX Extensions.</div>
                                        <span>
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Figure&nbsp;5&nbsp;Тип Person
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                  <span id="ctl00_MTContentSelector1_mainContentContainer_ctl41_ctl00_ctl00" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl41_ctl00_ctl00_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl41_ctl00_ctl00_code" space="preserve">namespace MsdnMagazine.SampleTypes
{
    public class Person
    {
        private string _firstName;
        private string _lastName;
        private int _age;
        private bool _married;

        public bool Married
        {
            get { return _married; } set { _married = value; }
        }

        public int Age
        {
            get { return _age; } set { _age = value; }
        }

        public string FirstName
        {
            get { return _firstName; } set { _firstName = value; }
        }

        public string LastName
        {
            get { return _lastName; } set { _lastName = value; }
        }
    }
}

</pre>
    </div>
</div>

</span>
                                        
</div>
</div>
</span>
                                        <span>
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Figure&nbsp;4&nbsp;Консольное приложение сериализации JSON
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                  <span id="ctl00_MTContentSelector1_mainContentContainer_ctl42_ctl00_ctl00" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl42_ctl00_ctl00_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl42_ctl00_ctl00_code" space="preserve">using System;
using System.Collections;
using System.Collections.Generic;
using Microsoft.Web.Script.Serialization;

class App
{
    static void Main()
    {
        Person p = new Person();
        p.FirstName = "Bob";
        p.LastName = "Smith";
        p.Age = 33;
        p.Married = true;

        JavaScriptSerializer jss = new JavaScriptSerializer();
        string serializedPerson = jss.Serialize(p);
        Console.WriteLine(serializedPerson);
    }
}

</pre>
    </div>
</div>

</span>
                                        
</div>
</div>
</span>
                                        <div class="ArticleNormalPara">
Результатом работы консольного приложения будет класс Person в формате JSON, а именно:
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl22" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl22_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl22_code" space="preserve">{"Married":true,"Age":33,"FirstName":"Bob","LastName":"Smith"}
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">Как и XmlSerializer, JavaScriptSerializer сериализует в тип только общедоступные данные; поддержка разрешения циклических ссылок отсутствует. Но все типы, включая, конечно же, DataSet, сериализуемые стандартными веб-службами ASMX, сериализуются и с помощью JavaScriptSerializer. Понимание этих принципов позволит создавать более функциональные веб-службы, обрабатывающие сложные типы так же легко, как веб-службы на основе протокола SOAP, определяемые в ASMX-файле.</div>
                                        <div class="ArticleNormalPara">В примере на <strong>рис. 6</strong> представлена веб-служба MarriageService, реализующая метод Marry для изменения атрибутов двух объектов Person, определенных выше. (Соответствующая страница ASP.NET имеется в разделе загрузки кода для данной статьи.)</div>
                                        <span>
<div class="MTPS_CollapsibleRegion">
<div class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img class="LibC_o" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/clear.gif" style="border-width:0px;vertical-align:middle;">
&nbsp;Figure&nbsp;6&nbsp;MarriageService.asmx
</div>
<div class="MTPS_CollapsibleSection" style="display:block;">  

                                                  <span id="ctl00_MTContentSelector1_mainContentContainer_ctl44_ctl00_ctl00" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl44_ctl00_ctl00_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl44_ctl00_ctl00_code" space="preserve">&lt;%@ WebService Language="C#" 
    Class="MsdnMagazine.MarriageService" %&gt;

using System;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;
using Microsoft.Web.Script.Services;
using MsdnMagazine.SampleTypes;

namespace MsdnMagazine
{
    [WebService(Namespace = "http://msdnmagazine.com/ws")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [ScriptService]
    [GenerateScriptType(typeof(Person))]
    public class MarriageService : WebService
    {
        [WebMethod]
        public Person[] Marry(Person[] couple)
        {
          if (couple.Length != 2)
            throw new ArgumentException("2 persons only!");
          if (couple[0].Married || couple[1].Married)
            throw new ArgumentException("Tell your spouse first!");
            
          couple[0].LastName += "-" + couple[1].LastName;
          couple[1].LastName = couple[0].LastName;
          couple[0].Married = couple[1].Married = true;
          return couple;
        }
    }
}

</pre>
    </div>
</div>

</span>
                                        
</div>
</div>
</span>
                                        <div class="ArticleNormalPara">Клиентский сценарий может также работать и с XML. Кроме стандартного атрибута WebMethod, используемого при определении веб-служб, в пространстве имен Microsoft.Web.Script.Services имеется новый атрибут ScriptMethod; его свойство ResponseFormat может принимать значения Json (по умолчанию) или Xml.
<span id="ctl00_MTContentSelector1_mainContentContainer_ctl25" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl25_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl25_code" space="preserve">namespace PS
{
    [ScriptService] 
    [WebService(Namespace = "http://pluralsight.com/ws")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    public class StockQuoteService : WebService
    {
        [WebMethod]
        public int GetStockQuote(string symbol)
        {
            return (new Random()).Next(0, 120);
        }
    }
}
</pre>
    </div>
</div>

</span>

Результатом сериализации в данном случае будет:

<span id="ctl00_MTContentSelector1_mainContentContainer_ctl26" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<div class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl26_">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTContentSelector1_mainContentContainer_ctl26_code" space="preserve">&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;int&gt;74&lt;/int&gt;
</pre>
    </div>
</div>

</span></div>
                                        <div class="ArticleNormalPara">При вызове данного метода из клиентского сценария JavaScript необходимо предусмотреть обработку ответа в формате XML. Это может пригодиться, если планируется его трансформация или уже используется MSXML.</div>
                                        <br>
                                        <div class="ArticleTypeTitle" id="S4">Заключение</div>
                                        <div class="ArticleNormalPara">Необходимо отметить, что в расширениях ASP.NET 2.0 AJAX Extensions имеются две готовые службы, удобные при работе с определенными службами приложений ASP.NET 2.0 из клиентского кода, —  ProfileService и AuthenicationService. Эти классы клиентского прокси позволяют устанавливать и получать значения профиля для отдельных клиентов, а также выполнять проверку подлинности (с помощью поставщика контроля членства, используемого по умолчанию) и предоставлять файлы «cookie» проверки подлинности в любой части клиентского сценария.</div>
                                        <div class="ArticleNormalPara">Несмотря на то, что при обсуждении и демонстрации расширений ASP.NET 2.0 AJAX Extensions значительно больше внимания уделяется эффектным элементам управления, позволяющим создавать интерактивные пользовательские интерфейсы, одной из самых впечатляющих и полезных особенностей этих расширений является возможность вызывать веб-службы непосредственно из клиентского сценария JavaScript. Благодаря полнофункциональному сериализатору .NET Framework/JSON, прямой интеграции с привычными веб-службами ASMX, поддержке пакетирования и автоматически генерируемым мостам для внешних веб-служб, данная возможность обеспечивает всеобъемлющую поддержку веб-служб, что делает ее наиболее привлекательной особенностью расширений ASP.NET 2.0 AJAX Extensions.</div>
                                        <br>
                                        <p class="clsGloss"> Присылайте ваши вопросы и замечания автору статьи по адресу: &nbsp;<a href="mailto:xtrmasp@microsoft.com.">xtrmasp@microsoft.com.</a>.
</p>
                                        <br>
                                        <div class="ContentSeparator"></div>
                                        <div class="AuthorBio">
                                                  <strong> Фриц Онион (Fritz Onion)</strong> является соучредителем компании Pluralsight, занимающейся подготовкой специалистов по Microsoft .NET. Он ведет курс разработки веб-приложений. Фриц Онион — автор книг «Основы ASP.NET с примерами на С#» (Издательство «Вильсон», 2003) и Essential ASP.NET 2.0 (Addison Wesley, 2006). С ним можно связаться через блог <a href="http://pluralsight.com/fritz">pluralsight.com/fritz</a> (на английском языке).</div>
                                        <br>
                                        <div id="bottom"></div>
                              </div>
                    </div>
                                                        
                                                </div>
                                                <div class="FeatureSmallHeadWithLogo">&nbsp;</div>
                                            </td>
                                            <td style="width: 303px; vertical-align: top; padding-left: 3px;" valign="top">
                                                <div id="RightContent">
                                                    <div id="ctl00_RightSideBox">
	<p:primary pcat:primaryformat="Mtps.Xhtml" xmlns:asp="http://msdn2.microsoft.com/aspnet" xmlns:pcat="urn:mtpg-com:mtps/2004/1/primary/category" xmlns:p="urn:mtpg-com:mtps/2004/1/primary"><div class="navpage"><div style="margin-bottom:10px;"><iframe frameborder="0" framespacing="0" height="250" id="4f2320cbb2378" name="4f2320cbb2378" scrolling="no" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/afr(1).htm" width="300">&lt;a id="ctl00_ctl15" href="http://ox-d.101m3.com/w/1.0/rc?cs=4f2320cbb2378&amp;cb=INSERT_RANDOM_NUMBER_HERE" onclick="javascript:Track('ctl00_ctl14|ctl00_ctl15',this);"&gt;&lt;img alt="" border="0" src="http://ox-d.101m3.com/w/1.0/ai?auid=139281&amp;amp;cs=4f2320cbb2378&amp;amp;cb=INSERT_RANDOM_NUMBER_HERE" /&gt;&lt;/a&gt;</iframe></div><div style="margin-bottom:10px;"><iframe frameborder="0" framespacing="0" height="250" id="4f2320971b57d" name="4f2320971b57d" scrolling="no" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/afr.htm" width="300">&lt;a id="ctl00_ctl16" href="http://ox-d.101m3.com/w/1.0/rc?cs=4f2320971b57d&amp;cb=INSERT_RANDOM_NUMBER_HERE" onclick="javascript:Track('ctl00_ctl14|ctl00_ctl16',this);"&gt;&lt;img alt="" border="0" src="http://ox-d.101m3.com/w/1.0/ai?auid=139280&amp;amp;cs=4f2320971b57d&amp;amp;cb=INSERT_RANDOM_NUMBER_HERE" /&gt;&lt;/a&gt;</iframe></div><div style="border-width:5px;border-color:black;border-style:solid;"><div style="margin-left:5px; margin-right:5px;"><h3><a id="ctl00_ctl17" href="http://blogs.msdn.com/msdnmagazine/" onclick="javascript:Track(&#39;ctl00_ctl14|ctl00_ctl17&#39;,this);">MSDN Magazine Blog</a></h3><p><!-- RSSURL : http://blogs.msdn.com/msdnmagazine/rss.xml | RSS GUID : 44CFFA5F-CCC2-14A2-2403-529DE793E787 --></p><div id="ctl00_ctl18_MtpsFeedViewerBasicPanelWebSlice" class="hslice">
		
	<p id="ctl00_ctl18_titlediv" class="entry-title"></p>
	<div class="entry-content">
			
		<div id="ctl00_ctl18_MtpsFeedViewerBasicPanel" class="MtpsFeedViewerBasicRootPanelClass">
				
			<div id="ctl00_ctl18_MtpsFeedViewerBasicHeaderPanel" class="MtpsFeedViewerBasicHeaderStylePanel">
					
			
				</div>
		<div class="ColumnDiv">
					<div id="ctl00_ctl18_ctl02" class="BasicHeadlinesItemPanelCssClass" style="width:99%;">
						<a id="ctl00_ctl18_ctl03" title="Author Q&amp;A: Building the Internet of Things" class="BasicHeadlinesTitleBold" href="http://blogs.msdn.com/b/msdnmagazine/archive/2012/03/09/10280629.aspx" onclick="javascript:Track(&#39;ctl00_ctl18_ctl02|ctl00_ctl18_ctl03&#39;,this);">Author Q&amp;A: Building the Internet of Things</a><br><span class="BasicHeadlinesDescLabelCssClass">In this month's issue of MSDN Magazine, Colin Miller and Torsten Grabs authored the lead feature titled "Building the Internet of Things." A... </span><a id="ctl00_ctl18_ctl06" title="Author Q&amp;amp;A: Building the Internet of Things" href="http://blogs.msdn.com/b/msdnmagazine/archive/2012/03/09/10280629.aspx" onclick="javascript:Track(&#39;ctl00_ctl18_ctl02|ctl00_ctl18_ctl06&#39;,this);">More...</a><br><span class="FVBPubDateLabel">пятница, мар 9</span>
					</div>
				</div><div class="ColumnDiv">
					<div id="ctl00_ctl18_ctl10" class="BasicHeadlinesItemPanelCssClass" style="width:99%;">
						<a id="ctl00_ctl18_ctl11" title="MSDN Magazine Web Site Gets an Update" class="BasicHeadlinesTitleBold" href="http://blogs.msdn.com/b/msdnmagazine/archive/2012/03/08/10280039.aspx" onclick="javascript:Track(&#39;ctl00_ctl18_ctl10|ctl00_ctl18_ctl11&#39;,this);">MSDN Magazine Web Site Gets an Update</a><br><span class="BasicHeadlinesDescLabelCssClass">The March issue of MSDN Magazine went live on the first of the month, and brought along with it a few changes to the MSDN Magazine Web site. Scroll do... </span><a id="ctl00_ctl18_ctl14" title="MSDN Magazine Web Site Gets an Update" href="http://blogs.msdn.com/b/msdnmagazine/archive/2012/03/08/10280039.aspx" onclick="javascript:Track(&#39;ctl00_ctl18_ctl10|ctl00_ctl18_ctl14&#39;,this);">More...</a><br><span class="FVBPubDateLabel">четверг, мар 8</span>
					</div>
				</div><div class="EmptyPanel">

				</div>
			</div>
	
		</div>

	</div><p></p><p><a id="ctl00_ctl19" href="http://blogs.msdn.com/msdnmagazine/" onclick="javascript:Track(&#39;ctl00_ctl14|ctl00_ctl19&#39;,this);">More MSDN Magazine Blog entries &gt;</a></p></div><div style="margin-left:5px; margin-right:5px; background-color:#5b6871;height:12px"><!--PublishThis!: An empty tag was encountered. This comment was inserted to prevent a self-closing tag.--></div><div style="margin-left:5px; margin-right:5px;"><p><br></p><div style="text-align:left;font-family:Segoe UI;font-size:12pt;">Current Issue</div><div style="text-align:center;display:block;height:260px"><p><a id="ctl00_ctl20" href="http://msdn.microsoft.com/ru-ru/magazine/hh852583.aspx" onclick="javascript:Track(&#39;ctl00_ctl14|ctl00_ctl20&#39;,this);"><br><img align="Middle" alt="March 2012" height="239" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/hh852583.cover_lrg(en-us,MSDN.10).png" title="March 2012" width="178"></a></p></div><div style="text-align:right;"><p><a id="ctl00_ctl21" href="http://msdn.microsoft.com/ru-ru/magazine/ee310108.aspx" onclick="javascript:Track(&#39;ctl00_ctl14|ctl00_ctl21&#39;,this);">Browse All MSDN Magazines</a><br></p></div><div style="background-color:#5b6871;height:12px"><!--PublishThis!: An empty tag was encountered. This comment was inserted to prevent a self-closing tag.--></div></div><div style="margin-left:5px; margin-right:5px;"><div style="text-align:Right;font-family:Segoe UI;font-size:12pt;"><p><br><a id="ctl00_ctl22" href="http://msdn.microsoft.com/en-US/aa570311.aspx?ocid=msdn_magazine" onclick="javascript:Track(&#39;ctl00_ctl14|ctl00_ctl22&#39;,this);"><img align="Left" alt="Subscribe to the MSDN Flash newsletter" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/dd799403.MSDN_Newsletter(en-us,MSDN.10).png" title="Subscribe to the MSDN Flash newsletter"> Subscribe to MSDN Flash newsletter</a></p></div><div style="text-align:left;"><p><br>Receive the MSDN Flash e-mail newsletter every other week, with news and information personalized to your interests and areas of focus.</p></div></div></div></div></p:primary>
</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody></table>
                                    <div id="ctl00_FooterAd" class="MsdnPage_ContentInclude" align="center"><div>
	<div>
		<div class="navpage"><p>&nbsp;</p><div><iframe frameborder="0" framespacing="0" height="90" id="4f2320f8e860a" name="4f2320f8e860a" scrolling="no" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/afr(2).htm" width="728">&lt;a id="ctl00_ctl31" href="http://ox-d.101m3.com/w/1.0/rc?cs=4f2320f8e860a&amp;cb=INSERT_RANDOM_NUMBER_HERE" onclick="javascript:Track('ctl00_ctl30|ctl00_ctl31',this);"&gt;&lt;img alt="" border="0" src="http://ox-d.101m3.com/w/1.0/ai?auid=139282&amp;amp;cs=4f2320f8e860a&amp;amp;cb=INSERT_RANDOM_NUMBER_HERE" /&gt;&lt;/a&gt;</iframe></div></div>
	</div>
</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="Clearbottom"> </div>
                        <div class="bottomleftcorner"> </div>
                        <div class="bottomrightcorner"> </div>
                        <div id="Footer">
                            

<div class="FooterLinks">
    <div id="ctl00_Footer1_SiteLinks">
	<a id="ctl00_Footer1_LocalFooterLink0" title="Управление профилем" href="http://go.microsoft.com/?linkid=8786242&lcid=1049">Управление профилем</a><span class="Pipe">|</span><a id="ctl00_Footer1_LocalFooterLink1" title="Юридическая информация" href="http://www.microsoft.com/legal/">Юридическая информация</a><span class="Pipe">|</span><a id="ctl00_Footer1_LocalFooterLink2" title="Бюллетень MSDN" href="http://www.microsoft.com/Rus/Msdn/flash/Default.mspx">Бюллетень MSDN</a>
</div>
    <span id="ctl00_Footer1_Copyright" title="© 2012  Microsoft. Все права защищены." class="FooterCopyright">© 2012  Microsoft. Все права защищены.</span>
    <a id="ctl00_Footer1_Terms" title="Условия использования" href="http://msdn.microsoft.com/ru-ru/cc300389.aspx">Условия использования</a>
    <span class="Pipe">|</span>
    <a id="ctl00_Footer1_Trademarks" title="Товарные знаки" href="http://www.microsoft.com/library/toolbar/3.0/trademarks/ru-ru.mspx">Товарные знаки</a>
    <span class="Pipe">|</span>
    <a id="ctl00_Footer1_PrivacyStatement" title="Конфиденциальность" href="http://www.microsoft.com/info/ru/privacy.mspx">Конфиденциальность</a>
    <span id="ctl00_Footer1_PipeSpan3" class="Pipe">|</span>
    <a id="ctl00_Footer1_Feedback" title="Отзывы и пожелания по сайту" rel="sitefeedback" targeturl="https://lab.msdn.microsoft.com/mailform/contactus.aspx?refurl=http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx&amp;loc=ru-ru" href="https://lab.msdn.microsoft.com/mailform/contactus.aspx?refurl=http://msdn.microsoft.com/ru-ru/magazine/cc163499.aspx&loc=ru-ru" target="_blank">Отзывы и пожелания по сайту</a>
</div>

                        </div>
                    
                </div>
            </div>
        </div>
    </div>
    <div style="display:none"><img src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/trans_pixel.asp" width="0" height="0" hspace="0" vspace="0" border="0" alt="Page view tracker"></div>
    
<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/webtrendsscript-bn1651.js" type="text/javascript"></script>
<noscript>
&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="http://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;
</noscript>
    <script type="text/javascript" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/mtps-bn1651.js"></script>
    

<script type="text/javascript">
//<![CDATA[
 RegisterAutoSubmit('ctl00_tb1_Flyout_Rating1','ctl00_tb1_Flyout_btnSend','contentRatingcc163499MSDN.10ru-ru');

//]]>
</script>
</form>


<script language="javascript" type="text/javascript" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/broker.js"></script>

<script src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/broker-config.js"></script><div style="display: none; " id="_WEDCSInsertedData"><iframe id="_msnFrame" src="./Непревзойденная технология ASP.NET  Клиентский вызов веб-служб средствами AJAX Extensions_files/Sync.htm" style="z-index:-1;height:1px;width:1px;display:none;visibility:hidden;" onload="javascript:MscomBeacon();"></iframe></div></body></html>